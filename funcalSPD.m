%itt keszitem el a keresett parameter eloszlast, ehhez eloszor biztositom h
%Sigma_P pozitiv semidefinit legyen
Sigma_P_val = [0.0000,-0.0171, 0.0000, 0.0000, 0.0012,-0.0001,-0.0002, 0.0000,-0.0000, 0.0000,-0.0000,0.0026,-0.0008,-0.0000, 0.0000, 0.0001,-0.0062, 0.0000;
-0.0171,17.9074,-0.0535,-0.0109,-0.6349, 0.0370, 0.1905,-0.0000,-0.0001,-0.0028,-0.0001,-2.5570,-0.0142,-0.0066, 0.0021,-0.1312, 3.9395,-0.0024;
 0.0000,-0.0535, 0.0005, 0.0001, 0.0038,-0.0004,-0.0007, 0.0000,-0.0000, 0.0000, 0.0000,0.0170,-0.0143, 0.0000,-0.0000, 0.0005,-0.0252, 0.0000;
 0.0000,-0.0109, 0.0001, 0.0002, 0.0033,-0.0003,-0.0001,-0.0000,-0.0000, 0.0000, 0.0000,0.0063,-0.0057,-0.0001, 0.0000, 0.0002,-0.0198,-0.0001;
 0.0012,-0.6349, 0.0038, 0.0033, 0.0918,-0.0078,-0.0058, 0.0000,-0.0001, 0.0006, 0.0000,0.1911,-0.2510,-0.0008, 0.0004, 0.0074,-0.4569, 0.0003;
-0.0001, 0.0370,-0.0004,-0.0003,-0.0078, 0.0011, 0.0004,-0.0000, 0.0000,-0.0001, 0.0000,-0.0174, 0.0325, 0.0002,-0.0000,-0.0006, 0.0324, 0.0000;
-0.0002, 0.1905,-0.0007,-0.0001,-0.0058, 0.0004, 0.0024,-0.0000,-0.0000,-0.0000,-0.0000,-0.0325,-0.0044,-0.0001, 0.0000,-0.0013, 0.0535, 0.0001;
 0.0000,-0.0000, 0.0000,-0.0000, 0.0000,-0.0000,-0.0000, 0.0000, 0.0000,-0.0000, 0.0000,0.0000, 0.0000,-0.0000, 0.0000, 0.0000,-0.0000, 0.0000;
-0.0000,-0.0001,-0.0000,-0.0000,-0.0001, 0.0000,-0.0000, 0.0000, 0.0000,-0.0000, 0.0000,-0.0001, 0.0006, 0.0000,-0.0000,-0.0000, 0.0004,-0.0000;
 0.0000,-0.0028, 0.0000, 0.0000, 0.0006,-0.0001,-0.0000,-0.0000,-0.0000, 0.0000, 0.0000,0.0011,-0.0014,-0.0000, 0.0000, 0.0000,-0.0032,-0.0000;
-0.0000,-0.0001, 0.0000, 0.0000, 0.0000, 0.0000,-0.0000, 0.0000, 0.0000, 0.0000,-0.0000,0.0000,-0.0000, 0.0000,-0.0000, 0.0000,-0.0001,-0.0000;
 0.0026,-2.5570, 0.0170, 0.0063, 0.1911,-0.0174,-0.0325, 0.0000,-0.0001, 0.0011, 0.0000,0.7842,-0.4463, 0.0003,-0.0006, 0.0235,-1.3176,-0.0011;
-0.0008,-0.0142,-0.0143,-0.0057,-0.2510, 0.0325,-0.0044, 0.0000, 0.0006,-0.0014,-0.0000,-0.4463, 2.0824, 0.0020,-0.0021,-0.0159, 0.5174,-0.0068;
-0.0000,-0.0066, 0.0000,-0.0001,-0.0008, 0.0002,-0.0001,-0.0000, 0.0000,-0.0000, 0.0000,0.0003, 0.0020, 0.0001,-0.0000, 0.0000, 0.0015, 0.0000;
 0.0000, 0.0021,-0.0000, 0.0000, 0.0004,-0.0000, 0.0000, 0.0000,-0.0000, 0.0000,-0.0000,-0.0006,-0.0021,-0.0000, 0.0000, 0.0000,-0.0015, 0.0000;
 0.0001,-0.1312, 0.0005, 0.0002, 0.0074,-0.0006,-0.0013, 0.0000,-0.0000, 0.0000, 0.0000,0.0235,-0.0159, 0.0000, 0.0000, 0.0011,-0.0395, 0.0001;
-0.0062, 3.9395,-0.0252,-0.0198,-0.4569, 0.0324, 0.0535,-0.0000, 0.0004,-0.0032,-0.0001,-1.3176, 0.5174, 0.0015,-0.0015,-0.0395, 4.0711,-0.0006;
 0.0000,-0.0024, 0.0000,-0.0001, 0.0003, 0.0000, 0.0001, 0.0000,-0.0000,-0.0000,-0.0000,-0.0011,-0.0068, 0.0000, 0.0000, 0.0001,-0.0006, 0.0002]

A= Sigma_P_val

B=nearestSPD(A)

eig(B)

issymmetric(B)

%disp(B)
parameterek_atlag_alapu = [0.0345192775248,9.36306346883, 0.0502860139359,0.0671801816115,0.0986651013104,0.487285742869,0.0785320232345,0.000178028006746,0.00198128401373,0.00472836079025,-0.0293415133234,1.97397711018,5.5279083377,0.305340240734,0.0112866326715,0.0817014108486,4.42551608175,0.1]

a=rand(18)
%figure;
X=a(1,:)
p = mvnrnd(parameterek_atlag_alapu,B,1)
disp(p);